/*!
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function InfoBox(opt_opts){opt_opts=opt_opts||{};google.maps.OverlayView.apply(this,arguments);this.content_=opt_opts.content||"";this.disableAutoPan_=opt_opts.disableAutoPan||!1;this.maxWidth_=opt_opts.maxWidth||0;this.pixelOffset_=opt_opts.pixelOffset||new google.maps.Size(0,0);this.position_=opt_opts.position||new google.maps.LatLng(0,0);this.zIndex_=opt_opts.zIndex||null;this.boxClass_=opt_opts.boxClass||"infoBox";this.boxStyle_=opt_opts.boxStyle||{};this.closeBoxMargin_=opt_opts.closeBoxMargin||"2px";this.closeBoxURL_=opt_opts.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif";if(opt_opts.closeBoxURL===""){this.closeBoxURL_=""}
this.infoBoxClearance_=opt_opts.infoBoxClearance||new google.maps.Size(1,1);if(typeof opt_opts.visible==="undefined"){if(typeof opt_opts.isHidden==="undefined"){opt_opts.visible=!0}else{opt_opts.visible=!opt_opts.isHidden}}
this.isHidden_=!opt_opts.visible;this.alignBottom_=opt_opts.alignBottom||!1;this.pane_=opt_opts.pane||"floatPane";this.enableEventPropagation_=opt_opts.enableEventPropagation||!1;this.div_=null;this.closeListener_=null;this.moveListener_=null;this.contextListener_=null;this.eventListeners_=null;this.fixedWidthSet_=null}
InfoBox.prototype=new google.maps.OverlayView();InfoBox.prototype.createInfoBoxDiv_=function(){var i;var events;var bw;var me=this;var cancelHandler=function(e){e.cancelBubble=!0;if(e.stopPropagation){e.stopPropagation()}};var ignoreHandler=function(e){e.returnValue=!1;if(e.preventDefault){e.preventDefault()}
if(!me.enableEventPropagation_){cancelHandler(e)}};if(!this.div_){this.div_=document.createElement("div");this.setBoxStyle_();if(typeof this.content_.nodeType==="undefined"){this.div_.innerHTML=this.getCloseBoxImg_()+this.content_}else{this.div_.innerHTML=this.getCloseBoxImg_();this.div_.appendChild(this.content_)}
this.getPanes()[this.pane_].appendChild(this.div_);this.addClickHandler_();if(this.div_.style.width){this.fixedWidthSet_=!0}else{if(this.maxWidth_!==0&&this.div_.offsetWidth>this.maxWidth_){this.div_.style.width=this.maxWidth_;this.div_.style.overflow="auto";this.fixedWidthSet_=!0}else{bw=this.getBoxWidths_();this.div_.style.width=(this.div_.offsetWidth-bw.left-bw.right)+"px";this.fixedWidthSet_=!1}}
this.panBox_(this.disableAutoPan_);if(!this.enableEventPropagation_){this.eventListeners_=[];events=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"];for(i=0;i<events.length;i++){this.eventListeners_.push(google.maps.event.addDomListener(this.div_,events[i],cancelHandler))}
this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(e){this.style.cursor="default"}))}
this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",ignoreHandler);google.maps.event.trigger(this,"domready")}};InfoBox.prototype.getCloseBoxImg_=function(){var img="";if(this.closeBoxURL_!==""){img="<img";img+=" src='"+this.closeBoxURL_+"'";img+=" align=right";img+=" style='";img+=" position: relative;";img+=" cursor: pointer;";img+=" margin: "+this.closeBoxMargin_+";";img+="'>"}
return img};InfoBox.prototype.addClickHandler_=function(){var closeBox;if(this.closeBoxURL_!==""){closeBox=this.div_.firstChild;this.closeListener_=google.maps.event.addDomListener(closeBox,"click",this.getCloseClickHandler_())}else{this.closeListener_=null}};InfoBox.prototype.getCloseClickHandler_=function(){var me=this;return function(e){e.cancelBubble=!0;if(e.stopPropagation){e.stopPropagation()}
google.maps.event.trigger(me,"closeclick");me.close()}};InfoBox.prototype.panBox_=function(disablePan){var map;var bounds;var xOffset=0,yOffset=0;if(!disablePan){map=this.getMap();if(map instanceof google.maps.Map){if(!map.getBounds().contains(this.position_)){map.setCenter(this.position_)}
bounds=map.getBounds();var mapDiv=map.getDiv();var mapWidth=mapDiv.offsetWidth;var mapHeight=mapDiv.offsetHeight;var iwOffsetX=this.pixelOffset_.width;var iwOffsetY=this.pixelOffset_.height;var iwWidth=this.div_.offsetWidth;var iwHeight=this.div_.offsetHeight;var padX=this.infoBoxClearance_.width;var padY=this.infoBoxClearance_.height;var pixPosition=this.getProjection().fromLatLngToContainerPixel(this.position_);if(pixPosition.x<(-iwOffsetX+padX)){xOffset=pixPosition.x+iwOffsetX-padX}else if((pixPosition.x+iwWidth+iwOffsetX+padX)>mapWidth){xOffset=pixPosition.x+iwWidth+iwOffsetX+padX-mapWidth}
if(this.alignBottom_){if(pixPosition.y<(-iwOffsetY+padY+iwHeight)){yOffset=pixPosition.y+iwOffsetY-padY-iwHeight}else if((pixPosition.y+iwOffsetY+padY)>mapHeight){yOffset=pixPosition.y+iwOffsetY+padY-mapHeight}}else{if(pixPosition.y<(-iwOffsetY+padY)){yOffset=pixPosition.y+iwOffsetY-padY}else if((pixPosition.y+iwHeight+iwOffsetY+padY)>mapHeight){yOffset=pixPosition.y+iwHeight+iwOffsetY+padY-mapHeight}}
if(!(xOffset===0&&yOffset===0)){var c=map.getCenter();map.panBy(xOffset,yOffset)}}}};InfoBox.prototype.setBoxStyle_=function(){var i,boxStyle;if(this.div_){this.div_.className=this.boxClass_;this.div_.style.cssText="";boxStyle=this.boxStyle_;for(i in boxStyle){if(boxStyle.hasOwnProperty(i)){this.div_.style[i]=boxStyle[i]}}
this.div_.style.WebkitTransform="translateZ(0)";if(typeof this.div_.style.opacity!=="undefined"&&this.div_.style.opacity!==""){this.div_.style.MsFilter="\"progid:DXImageTransform.Microsoft.Alpha(Opacity="+(this.div_.style.opacity*100)+")\"";this.div_.style.filter="alpha(opacity="+(this.div_.style.opacity*100)+")"}
this.div_.style.position="absolute";this.div_.style.visibility='hidden';if(this.zIndex_!==null){this.div_.style.zIndex=this.zIndex_}}};InfoBox.prototype.getBoxWidths_=function(){var computedStyle;var bw={top:0,bottom:0,left:0,right:0};var box=this.div_;if(document.defaultView&&document.defaultView.getComputedStyle){computedStyle=box.ownerDocument.defaultView.getComputedStyle(box,"");if(computedStyle){bw.top=parseInt(computedStyle.borderTopWidth,10)||0;bw.bottom=parseInt(computedStyle.borderBottomWidth,10)||0;bw.left=parseInt(computedStyle.borderLeftWidth,10)||0;bw.right=parseInt(computedStyle.borderRightWidth,10)||0}}else if(document.documentElement.currentStyle){if(box.currentStyle){bw.top=parseInt(box.currentStyle.borderTopWidth,10)||0;bw.bottom=parseInt(box.currentStyle.borderBottomWidth,10)||0;bw.left=parseInt(box.currentStyle.borderLeftWidth,10)||0;bw.right=parseInt(box.currentStyle.borderRightWidth,10)||0}}
return bw};InfoBox.prototype.onRemove=function(){if(this.div_){this.div_.parentNode.removeChild(this.div_);this.div_=null}};InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var pixPosition=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=(pixPosition.x+this.pixelOffset_.width)+"px";if(this.alignBottom_){this.div_.style.bottom=-(pixPosition.y+this.pixelOffset_.height)+"px"}else{this.div_.style.top=(pixPosition.y+this.pixelOffset_.height)+"px"}
if(this.isHidden_){this.div_.style.visibility="hidden"}else{this.div_.style.visibility="visible"}};InfoBox.prototype.setOptions=function(opt_opts){if(typeof opt_opts.boxClass!=="undefined"){this.boxClass_=opt_opts.boxClass;this.setBoxStyle_()}
if(typeof opt_opts.boxStyle!=="undefined"){this.boxStyle_=opt_opts.boxStyle;this.setBoxStyle_()}
if(typeof opt_opts.content!=="undefined"){this.setContent(opt_opts.content)}
if(typeof opt_opts.disableAutoPan!=="undefined"){this.disableAutoPan_=opt_opts.disableAutoPan}
if(typeof opt_opts.maxWidth!=="undefined"){this.maxWidth_=opt_opts.maxWidth}
if(typeof opt_opts.pixelOffset!=="undefined"){this.pixelOffset_=opt_opts.pixelOffset}
if(typeof opt_opts.alignBottom!=="undefined"){this.alignBottom_=opt_opts.alignBottom}
if(typeof opt_opts.position!=="undefined"){this.setPosition(opt_opts.position)}
if(typeof opt_opts.zIndex!=="undefined"){this.setZIndex(opt_opts.zIndex)}
if(typeof opt_opts.closeBoxMargin!=="undefined"){this.closeBoxMargin_=opt_opts.closeBoxMargin}
if(typeof opt_opts.closeBoxURL!=="undefined"){this.closeBoxURL_=opt_opts.closeBoxURL}
if(typeof opt_opts.infoBoxClearance!=="undefined"){this.infoBoxClearance_=opt_opts.infoBoxClearance}
if(typeof opt_opts.isHidden!=="undefined"){this.isHidden_=opt_opts.isHidden}
if(typeof opt_opts.visible!=="undefined"){this.isHidden_=!opt_opts.visible}
if(typeof opt_opts.enableEventPropagation!=="undefined"){this.enableEventPropagation_=opt_opts.enableEventPropagation}
if(this.div_){this.draw()}};InfoBox.prototype.setContent=function(content){this.content_=content;if(this.div_){if(this.closeListener_){google.maps.event.removeListener(this.closeListener_);this.closeListener_=null}
if(!this.fixedWidthSet_){this.div_.style.width=""}
if(typeof content.nodeType==="undefined"){this.div_.innerHTML=this.getCloseBoxImg_()+content}else{this.div_.innerHTML=this.getCloseBoxImg_();this.div_.appendChild(content)}
if(!this.fixedWidthSet_){this.div_.style.width=this.div_.offsetWidth+"px";if(typeof content.nodeType==="undefined"){this.div_.innerHTML=this.getCloseBoxImg_()+content}else{this.div_.innerHTML=this.getCloseBoxImg_();this.div_.appendChild(content)}}
this.addClickHandler_()}
google.maps.event.trigger(this,"content_changed")};InfoBox.prototype.setPosition=function(latlng){this.position_=latlng;if(this.div_){this.draw()}
google.maps.event.trigger(this,"position_changed")};InfoBox.prototype.setZIndex=function(index){this.zIndex_=index;if(this.div_){this.div_.style.zIndex=index}
google.maps.event.trigger(this,"zindex_changed")};InfoBox.prototype.setVisible=function(isVisible){this.isHidden_=!isVisible;if(this.div_){this.div_.style.visibility=(this.isHidden_?"hidden":"visible")}};InfoBox.prototype.getContent=function(){return this.content_};InfoBox.prototype.getPosition=function(){return this.position_};InfoBox.prototype.getZIndex=function(){return this.zIndex_};InfoBox.prototype.getVisible=function(){var isVisible;if((typeof this.getMap()==="undefined")||(this.getMap()===null)){isVisible=!1}else{isVisible=!this.isHidden_}
return isVisible};InfoBox.prototype.show=function(){this.isHidden_=!1;if(this.div_){this.div_.style.visibility="visible"}};InfoBox.prototype.hide=function(){this.isHidden_=!0;if(this.div_){this.div_.style.visibility="hidden"}};InfoBox.prototype.open=function(map,anchor){var me=this;if(anchor){this.position_=anchor.getPosition();this.moveListener_=google.maps.event.addListener(anchor,"position_changed",function(){me.setPosition(this.getPosition())})}
this.setMap(map);if(this.div_){this.panBox_()}};InfoBox.prototype.close=function(){var i;if(this.closeListener_){google.maps.event.removeListener(this.closeListener_);this.closeListener_=null}
if(this.eventListeners_){for(i=0;i<this.eventListeners_.length;i++){google.maps.event.removeListener(this.eventListeners_[i])}
this.eventListeners_=null}
if(this.moveListener_){google.maps.event.removeListener(this.moveListener_);this.moveListener_=null}
if(this.contextListener_){google.maps.event.removeListener(this.contextListener_);this.contextListener_=null}
this.setMap(null)};
jQuery(document).ready(function($){var geocoder,map,directionsDisplay,directionsService,autoCompleteLatLng,activeWindowMarkerId,infoWindow,markerClusterer,startMarkerData,startAddress,openInfoWindow=[],markersArray=[],mapsArray=[],markerSettings={},directionMarkerPosition={},mapDefaults={},resetMap=!1,streetViewAvailable=!1,autoLoad=(typeof wpslSettings!=="undefined")?wpslSettings.autoLoad:"",userGeolocation={},statistics={enabled:(typeof wpslSettings.collectStatistics!=="undefined")?!0:!1,address_components:''};var changeLocation=function(){var store_id=$(this).data('store-id');var store_page_id=$(this).data('store-page-id');var store_code_name=$(this).data('store-code-name');console.log(store_id);console.log(store_page_id);console.log(store_code_name);if(!store_id){return}
createCookie('crd_store_id',''+store_id,365);createCookie('crd_store_page_id',''+store_page_id,365);createCookie('crd_store_code_name',''+store_code_name,365);setTimeout(function(){location.reload()},50)};$(document).on('click','.wpsl-change-location',changeLocation);$(document).on('click','#wpslChangeLocation',changeLocation);function createCookie(name,value,days){var expires;if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString()}else{expires=""}
document.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)+expires+"; path=/"}
function readCookie(name){var nameEQ=encodeURIComponent(name)+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===' ')
c=c.substring(1,c.length);if(c.indexOf(nameEQ)===0)
return decodeURIComponent(c.substring(nameEQ.length,c.length))}
return null}
function eraseCookie(name){createCookie(name,"",-1)}
_.templateSettings={evaluate:/\<\%(.+?)\%\>/g,interpolate:/\<\%=(.+?)\%\>/g,escape:/\<\%-(.+?)\%\>/g};if($(".wpsl-gmap-canvas").length){$("<img />").attr("src",wpslSettings.url+"img/ajax-loader.gif");$(".wpsl-gmap-canvas").each(function(mapIndex){var mapId=$(this).attr("id");initializeGmap(mapId,mapIndex)});maybeApplyTabFix()}
function initializeGmap(mapId,mapIndex){var mapOptions,mapDetails,settings,infoWindow,latLng,bounds,mapData,zoomLevel,defaultZoomLevel=Number(wpslSettings.zoomLevel),maxZoom=Number(wpslSettings.autoZoomLevel);settings=getMapSettings(mapIndex);zoomLevel=Number(settings.zoomLevel);if(zoomLevel!==defaultZoomLevel){maxZoom=zoomLevel}
infoWindow=newInfoWindow();geocoder=new google.maps.Geocoder();directionsDisplay=new google.maps.DirectionsRenderer();directionsService=new google.maps.DirectionsService();mapOptions={zoom:zoomLevel,center:settings.startLatLng,mapTypeId:google.maps.MapTypeId[settings.mapType.toUpperCase()],mapTypeControl:Number(settings.mapTypeControl)?!0:!1,scrollwheel:Number(settings.scrollWheel)?!0:!1,streetViewControl:Number(settings.streetView)?!0:!1,gestureHandling:settings.gestureHandling,zoomControlOptions:{position:google.maps.ControlPosition[settings.controlPosition.toUpperCase()+'_TOP']}};markerSettings=getMarkerSettings();map=new google.maps.Map(document.getElementById(mapId),mapOptions);maybeApplyMapStyle(settings.mapStyle);if((typeof window["wpslMap_"+mapIndex]!=="undefined")&&(typeof window["wpslMap_"+mapIndex].locations!=="undefined")){bounds=new google.maps.LatLngBounds(),mapData=window["wpslMap_"+mapIndex].locations;$.each(mapData,function(index){latLng=new google.maps.LatLng(mapData[index].lat,mapData[index].lng);addMarker(latLng,mapData[index].id,mapData[index],!1,infoWindow);bounds.extend(latLng)});if(mapData.length>1){attachBoundsChangedListener(map,maxZoom);map.fitBounds(bounds)}
if(_.isArray(wpslSettings.mapTabAnchor)){mapDetails={map:map,bounds:bounds,maxZoom:maxZoom};mapsArray.push(mapDetails)}}
if($("#wpsl-gmap").length){if(wpslSettings.autoComplete==1){activateAutocomplete()}
if(!checkMobileUserAgent()&&$(".wpsl-dropdown").length&&wpslSettings.enableStyledDropdowns==1){createDropdowns()}else{$("#wpsl-search-wrap select").show();if(checkMobileUserAgent()){$("#wpsl-wrap").addClass("wpsl-mobile")}else{$("#wpsl-wrap").addClass("wpsl-default-filters")}}
if(!$(".wpsl-search").hasClass("wpsl-widget")&&!readCookie('crd_store_id')){if(wpslSettings.autoLocate==1){checkGeolocation(settings.startLatLng,infoWindow)}else if(wpslSettings.autoLoad==1){showStores(settings.startLatLng,infoWindow)}}
if(wpslSettings.mouseFocus==1&&!checkMobileUserAgent()){$("#wpsl-search-input").focus()}
searchLocationBtn(infoWindow);mapControlIcons(settings,map,infoWindow);checkWidgetSubmit()}
zoomChangedListener()}
function activateAutocomplete(){var input,autocomplete,place,options={};if(typeof wpslSettings.geocodeComponents!=="undefined"&&!$.isEmptyObject(wpslSettings.geocodeComponents)){options.componentRestrictions=wpslSettings.geocodeComponents}
input=document.getElementById("wpsl-search-input");autocomplete=new google.maps.places.Autocomplete(input,options);autocomplete.addListener("place_changed",function(){place=autocomplete.getPlace();if(place.geometry){autoCompleteLatLng=place.geometry.location}})}
function zoomChangedListener(){if(typeof wpslSettings.markerZoomTo!=="undefined"&&wpslSettings.markerZoomTo==1){google.maps.event.addListener(map,"zoom_changed",function(){checkMaxZoomLevel()})}}
function getMapSettings(mapIndex){var j,len,shortCodeVal,settingOptions=["zoomLevel","mapType","mapTypeControl","mapStyle","streetView","scrollWheel","controlPosition"],mapSettings={zoomLevel:wpslSettings.zoomLevel,mapType:wpslSettings.mapType,mapTypeControl:wpslSettings.mapTypeControl,mapStyle:wpslSettings.mapStyle,streetView:wpslSettings.streetView,scrollWheel:wpslSettings.scrollWheel,controlPosition:wpslSettings.controlPosition,gestureHandling:wpslSettings.gestureHandling};if((typeof window["wpslMap_"+mapIndex]!=="undefined")&&(typeof window["wpslMap_"+mapIndex].shortCode!=="undefined")){for(j=0,len=settingOptions.length;j<len;j++){shortCodeVal=window["wpslMap_"+mapIndex].shortCode[settingOptions[j]];if(typeof shortCodeVal!=="undefined"){mapSettings[settingOptions[j]]=shortCodeVal}}}
mapSettings.startLatLng=getStartLatlng(mapIndex);return mapSettings}
function getStartLatlng(mapIndex){var startLatLng,latLng,firstLocation="";if((typeof window["wpslMap_"+mapIndex]!=="undefined")&&(typeof window["wpslMap_"+mapIndex].locations!=="undefined")){firstLocation=window["wpslMap_"+mapIndex].locations[0]}
if((typeof firstLocation!=="undefined"&&typeof firstLocation.lat!=="undefined")&&(typeof firstLocation.lng!=="undefined")){startLatLng=new google.maps.LatLng(firstLocation.lat,firstLocation.lng)}else if(wpslSettings.startLatlng!==""){latLng=wpslSettings.startLatlng.split(",");startLatLng=new google.maps.LatLng(latLng[0],latLng[1])}else{startLatLng=new google.maps.LatLng(0,0)}
return startLatLng}
function newInfoWindow(){var boxClearance,boxPixelOffset,infoBoxOptions={};if((typeof wpslSettings.infoWindowStyle!=="undefined")&&(wpslSettings.infoWindowStyle=="infobox")){boxClearance=wpslSettings.infoBoxClearance.split(",");boxPixelOffset=wpslSettings.infoBoxPixelOffset.split(",");infoBoxOptions={alignBottom:!0,boxClass:wpslSettings.infoBoxClass,closeBoxMargin:wpslSettings.infoBoxCloseMargin,closeBoxURL:wpslSettings.infoBoxCloseUrl,content:"",disableAutoPan:(Number(wpslSettings.infoBoxDisableAutoPan))?!0:!1,enableEventPropagation:(Number(wpslSettings.infoBoxEnableEventPropagation))?!0:!1,infoBoxClearance:new google.maps.Size(Number(boxClearance[0]),Number(boxClearance[1])),pixelOffset:new google.maps.Size(Number(boxPixelOffset[0]),Number(boxPixelOffset[1])),zIndex:Number(wpslSettings.infoBoxZindex)};infoWindow=new InfoBox(infoBoxOptions)}else{infoWindow=new google.maps.InfoWindow()}
return infoWindow}
function getMarkerSettings(){var markerProp,markerProps=wpslSettings.markerIconProps,settings={};if(typeof markerProps.url!=="undefined"){settings.url=markerProps.url}else if(typeof markerProps.categoryMarkerUrl!=="undefined"){settings.categoryMarkerUrl=markerProps.categoryMarkerUrl}else if(typeof markerProps.alternateMarkerUrl!=="undefined"){settings.alternateMarkerUrl=markerProps.alternateMarkerUrl}else{settings.url=wpslSettings.url+"img/markers/"}
for(var key in markerProps){if(markerProps.hasOwnProperty(key)){markerProp=markerProps[key].split(",");if(markerProp.length==2){settings[key]=markerProp}}}
return settings}
function maybeApplyMapStyle(mapStyle){mapStyle=tryParseJSON(mapStyle);if(mapStyle){map.setOptions({styles:mapStyle})}}
function tryParseJSON(jsonString){try{var o=JSON.parse(jsonString);if(o&&typeof o==="object"&&o!==null){return o}}catch(e){}
return!1}
function showStores(startLatLng,infoWindow){addMarker(startLatLng,0,'',!0,infoWindow);findStoreLocations(startLatLng,resetMap,autoLoad,infoWindow)}
function checkMobileUserAgent(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}
function checkGeolocation(startLatLng,infoWindow){if(navigator.geolocation){var geolocationInProgress,locationTimeout,keepStartMarker=!1,timeout=Number(wpslSettings.geoLocationTimeout);geolocationInProgress=setInterval(function(){$(".wpsl-icon-direction").toggleClass("wpsl-active-icon")},600);locationTimeout=setTimeout(function(){geolocationFinished(geolocationInProgress);showStores(startLatLng,infoWindow)},timeout);navigator.geolocation.getCurrentPosition(function(position){geolocationFinished(geolocationInProgress);clearTimeout(locationTimeout);deleteOverlays(keepStartMarker);handleGeolocationQuery(startLatLng,position,resetMap,infoWindow);$(".wpsl-search").addClass("wpsl-geolocation-run")},function(error){if($(".wpsl-icon-direction").hasClass("wpsl-user-activated")&&!$(".wpsl-search").hasClass("wpsl-geolocation-run")){var msg;switch(error.code){case error.PERMISSION_DENIED:msg=wpslGeolocationErrors.denied;break;case error.POSITION_UNAVAILABLE:msg=wpslGeolocationErrors.unavailable;break;case error.TIMEOUT:msg=wpslGeolocationErrors.timeout;break;default:msg=wpslGeolocationErrors.generalError;break}
console.error(msg);$(".wpsl-icon-direction").removeClass("wpsl-active-icon")}else if(!$(".wpsl-search").hasClass("wpsl-geolocation-run")){clearTimeout(locationTimeout);showStores(startLatLng,infoWindow)}},{maximumAge:60000,timeout:timeout,enableHighAccuracy:!0})}else{console.error(wpslGeolocationErrors.unavailable);showStores(startLatLng,infoWindow)}}
function geolocationFinished(geolocationInProgress){clearInterval(geolocationInProgress);$(".wpsl-icon-direction").removeClass("wpsl-active-icon")}
function handleGeolocationQuery(startLatLng,position,resetMap,infoWindow){if(typeof(position)==="undefined"){showStores(startLatLng,infoWindow)}else{var latLng=new google.maps.LatLng(position.coords.latitude,position.coords.longitude);userGeolocation={position:position,newRequest:!0};map.setCenter(latLng);addMarker(latLng,0,'',!0,infoWindow);findStoreLocations(latLng,resetMap,autoLoad,infoWindow)}}
function searchLocationBtn(infoWindow){$("#wpsl-search-btn").unbind("click").bind("click",function(e){var keepStartMarker=!1;$("#wpsl-search-input").removeClass();if(!$("#wpsl-search-input").val()){$("#wpsl-search-input").addClass("wpsl-error").focus()}else{$("#wpsl-result-list ul").empty();$("#wpsl-stores").show();$(".wpsl-direction-before, .wpsl-direction-after").remove();$("#wpsl-direction-details").hide();resetMap=!1;closeInfoBoxWindow();deleteOverlays(keepStartMarker);deleteStartMarker();if(wpslSettings.autoComplete==1&&typeof autoCompleteLatLng!=="undefined"){prepareStoreSearch(autoCompleteLatLng,infoWindow)}else{codeAddress(infoWindow)}}
return!1})}
function closeInfoBoxWindow(){if((typeof wpslSettings.infoWindowStyle!=="undefined")&&(wpslSettings.infoWindowStyle=="infobox")&&typeof openInfoWindow[0]!=="undefined"){openInfoWindow[0].close()}}
function mapControlIcons(settings,map,infoWindow){google.maps.event.addListenerOnce(map,"tilesloaded",function(){$(".gm-style").append(wpslSettings.mapControls);if($(".wpsl-icon-reset, #wpsl-reset-map").length>0){resetMapBtn(settings.startLatLng,infoWindow);$(".wpsl-icon-reset").hide()}
$(".wpsl-icon-direction").on("click",function(){$(this).addClass("wpsl-user-activated");checkGeolocation(settings.startLatLng,infoWindow)})})}
function resetMapBtn(startLatLng,infoWindow){$(".wpsl-icon-reset, #wpsl-reset-map").on("click",function(){var keepStartMarker=!1,resetMap=!0;if($(this).hasClass("wpsl-in-progress")){return}
if(wpslSettings.autoLoad==1){autoLoad=1}
if((((map.getCenter().lat()!==mapDefaults.centerLatlng.lat())||(map.getCenter().lng()!==mapDefaults.centerLatlng.lng())||(map.getZoom()!==mapDefaults.zoomLevel)))){deleteOverlays(keepStartMarker);$("#wpsl-search-input").val("").removeClass();$(".wpsl-icon-reset").addClass("wpsl-in-progress");if(markerClusterer){markerClusterer.clearMarkers()}
deleteStartMarker();resetDropdowns();if(wpslSettings.autoLocate==1){handleGeolocationQuery(startLatLng,userGeolocation.position,resetMap,infoWindow)}else{showStores(startLatLng,infoWindow)}}
$("#wpsl-stores").show();$("#wpsl-direction-details").hide()})}
function deleteStartMarker(){if((typeof(startMarkerData)!=="undefined")&&(startMarkerData!=="")){startMarkerData.setMap(null);startMarkerData=""}}
function resetDropdowns(){var i,arrayLength,dataValue,catText,$customDiv,$customFirstLi,customSelectedText,customSelectedData,defaultFilters=$("#wpsl-wrap").hasClass("wpsl-default-filters"),defaultValues=[wpslSettings.searchRadius+' '+wpslSettings.distanceUnit,wpslSettings.maxResults],dropdowns=["wpsl-radius","wpsl-results"];for(i=0,arrayLength=dropdowns.length;i<arrayLength;i++){$("#"+dropdowns[i]+" select").val(parseInt(defaultValues[i]));$("#"+dropdowns[i]+" li").removeClass();if(dropdowns[i]=="wpsl-radius"){dataValue=wpslSettings.searchRadius}else if(dropdowns[i]=="wpsl-results"){dataValue=wpslSettings.maxResults}
$("#"+dropdowns[i]+" li").each(function(){if($(this).text()===defaultValues[i]){$(this).addClass("wpsl-selected-dropdown");$("#"+dropdowns[i]+" .wpsl-selected-item").html(defaultValues[i]).attr("data-value",dataValue)}})}
if($("#wpsl-category").length){$("#wpsl-category select").val(0);$("#wpsl-category li").removeClass();$("#wpsl-category li:first-child").addClass("wpsl-selected-dropdown");catText=$("#wpsl-category li:first-child").text();$("#wpsl-category .wpsl-selected-item").html(catText).attr("data-value",0)}
if($(".wpsl-custom-dropdown").length>0){$(".wpsl-custom-dropdown").each(function(index){if(!defaultFilters){$customDiv=$(this).siblings("div");$customFirstLi=$customDiv.find("li:first-child");customSelectedText=$customFirstLi.text();customSelectedData=$customFirstLi.attr("data-value");$customDiv.find("li").removeClass();$customDiv.prev().html(customSelectedText).attr("data-value",customSelectedData)}else{$(this).find("option").removeAttr("selected")}})}}
$("#wpsl-result-list").on("click",".wpsl-back",function(){var i,len;directionsDisplay.setMap(null);for(i=0,len=markersArray.length;i<len;i++){markersArray[i].setMap(map)}
if((typeof(startMarkerData)!=="undefined")&&(startMarkerData!=="")){startMarkerData.setMap(map)}
if(markerClusterer){checkMarkerClusters()}
map.setCenter(directionMarkerPosition.centerLatlng);map.setZoom(directionMarkerPosition.zoomLevel);$(".wpsl-direction-before, .wpsl-direction-after").remove();$("#wpsl-stores").show();$("#wpsl-direction-details").hide();return!1});function renderDirections(e){var i,start,end,len,storeId;closeInfoBoxWindow();if(e.parents("li").length>0){storeId=e.parents("li").data("store-id")}else{storeId=e.parents(".wpsl-info-window").data("store-id")}
if((typeof(startMarkerData)!=="undefined")&&(startMarkerData!=="")){start=startMarkerData.getPosition()}
directionMarkerPosition={centerLatlng:map.getCenter(),zoomLevel:map.getZoom()};for(i=0,len=markersArray.length;i<len;i++){if((markersArray[i].storeId==0)&&((typeof(start)==="undefined")||(start===""))){start=markersArray[i].getPosition()}else if(markersArray[i].storeId==storeId){end=markersArray[i].getPosition()}}
if(start&&end){$("#wpsl-direction-details ul").empty();$(".wpsl-direction-before, .wpsl-direction-after").remove();calcRoute(start,end)}else{console.error(wpslLabels.generalError)}}
if($("#wpsl-gmap").length){if(wpslSettings.markerEffect=='bounce'){$("#wpsl-stores").on("mouseenter","li",function(){letsBounce($(this).data("store-id"),"start")});$("#wpsl-stores").on("mouseleave","li",function(){letsBounce($(this).data("store-id"),"stop")})}else if(wpslSettings.markerEffect=='info_window'){$("#wpsl-stores").on("mouseenter","li",function(){var i,len;for(i=0,len=markersArray.length;i<len;i++){if(markersArray[i].storeId==$(this).data("store-id")){google.maps.event.trigger(markersArray[i],"click");map.setCenter(markersArray[i].position)}}})}}
function letsBounce(storeId,status){var i,len,marker;for(i=0,len=markersArray.length;i<len;i++){if(markersArray[i].storeId==storeId){marker=markersArray[i];if(status=="start"){marker.setAnimation(google.maps.Animation.BOUNCE)}else{marker.setAnimation(null)}}}}
function calcRoute(start,end){var legs,len,step,index,direction,i,j,distanceUnit,directionOffset,request,directionStops="";if(wpslSettings.distanceUnit=="km"){distanceUnit='METRIC'}else{distanceUnit='IMPERIAL'}
request={origin:start,destination:end,travelMode:wpslSettings.directionsTravelMode,unitSystem:google.maps.UnitSystem[distanceUnit]};directionsService.route(request,function(response,status){if(status==google.maps.DirectionsStatus.OK){directionsDisplay.setMap(map);directionsDisplay.setDirections(response);if(response.routes.length>0){direction=response.routes[0];for(i=0;i<direction.legs.length;i++){legs=direction.legs[i];for(j=0,len=legs.steps.length;j<len;j++){step=legs.steps[j];index=j+1;directionStops=directionStops+"<li><div class='wpsl-direction-index'>"+index+"</div><div class='wpsl-direction-txt'>"+step.instructions+"</div><div class='wpsl-direction-distance'>"+step.distance.text+"</div></li>"}}
$("#wpsl-direction-details ul").append(directionStops).before("<div class='wpsl-direction-before'><a class='wpsl-back' id='wpsl-direction-start' href='#'>"+wpslLabels.back+"</a><div><span class='wpsl-total-distance'>"+direction.legs[0].distance.text+"</span> - <span class='wpsl-total-durations'>"+direction.legs[0].duration.text+"</span></div></div>").after("<p class='wpsl-direction-after'>"+response.routes[0].copyrights+"</p>");$("#wpsl-direction-details").show();for(i=0,len=markersArray.length;i<len;i++){markersArray[i].setMap(null)}
if(markerClusterer){markerClusterer.clearMarkers()}
if((typeof(startMarkerData)!=="undefined")&&(startMarkerData!=="")){startMarkerData.setMap(null)}
$("#wpsl-stores").hide();if(wpslSettings.templateId==1){directionOffset=$("#wpsl-gmap").offset();$(window).scrollTop(directionOffset.top)}}}else{directionErrors(status)}})}
function codeAddress(infoWindow){var latLng,request={'address':$("#wpsl-search-input").val()};if(typeof wpslSettings.geocodeComponents!=="undefined"&&!$.isEmptyObject(wpslSettings.geocodeComponents)){request.componentRestrictions=wpslSettings.geocodeComponents}
geocoder.geocode(request,function(response,status){if(status==google.maps.GeocoderStatus.OK){if(statistics.enabled){statistics.address_components=response[0].address_components}
latLng=response[0].geometry.location;prepareStoreSearch(latLng,infoWindow)}else{geocodeErrors(status)}})}
function prepareStoreSearch(latLng,infoWindow){var autoLoad=!1;addMarker(latLng,0,'',!0,infoWindow);findStoreLocations(latLng,resetMap,autoLoad,infoWindow)}
function reverseGeocode(latLng,callback){geocoder.geocode({'latLng':latLng},function(response,status){if(status==google.maps.GeocoderStatus.OK){if(wpslSettings.autoLocate==1&&userGeolocation.newRequest){var zipCode=filterApiResponse(response);if(zipCode!==""){$("#wpsl-search-input").val(zipCode)}
userGeolocation.newRequest=!1}
if(wpslSettings.directionRedirect){startAddress=response[0].formatted_address}
if(statistics.enabled){statistics.address_components=response[0].address_components}
if(callback){callback()}}else{geocodeErrors(status)}})}
function filterApiResponse(response){var zipcode,responseType,i,addressLength=response[0].address_components.length;for(i=0;i<addressLength;i++){responseType=response[0].address_components[i].types;if((/^postal_code$/.test(responseType))||(/^postal_code,postal_code_prefix$/.test(responseType))){zipcode=response[0].address_components[i].long_name}}
return zipcode}
function findStoreLocations(startLatLng,resetMap,autoLoad,infoWindow){if(wpslSettings.directionRedirect==1||statistics.enabled){reverseGeocode(startLatLng,function(){makeAjaxRequest(startLatLng,resetMap,autoLoad,infoWindow)})}else{makeAjaxRequest(startLatLng,resetMap,autoLoad,infoWindow)}}
function makeAjaxRequest(startLatLng,resetMap,autoLoad,infoWindow){var latLng,noResultsMsg,ajaxData,storeData="",draggable=!1,template=$("#wpsl-listing-template").html(),$storeList=$("#wpsl-stores ul"),preloader=wpslSettings.url+"img/ajax-loader.gif";ajaxData=collectAjaxData(startLatLng,resetMap,autoLoad);$storeList.empty().append("<li class='wpsl-preloader'><img src='"+preloader+"'/>"+wpslLabels.preloader+"</li>");$("#wpsl-wrap").removeClass("wpsl-no-results");$.get(wpslSettings.ajaxurl,ajaxData,function(response){$(".wpsl-preloader, .no-results").remove();if(response.length>0&&typeof response.addon=="undefined"){$.each(response,function(index){_.extend(response[index],templateHelpers);latLng=new google.maps.LatLng(response[index].lat,response[index].lng);addMarker(latLng,response[index].id,response[index],draggable,infoWindow);response[index].store_id=response[index].store_id?response[index].store_id:undefined;storeData=storeData+_.template(template)(response[index])});$("#wpsl-result-list").off("click",".wpsl-directions");$storeList.empty();$storeList.append(storeData);$("#wpsl-result-list").on("click",".wpsl-directions",function(){if(wpslSettings.directionRedirect!=1){renderDirections($(this));return!1}});checkMarkerClusters();$("#wpsl-result-list p:empty").remove()}else{addMarker(startLatLng,0,'',!0,infoWindow);noResultsMsg=getNoResultsMsg();$("#wpsl-wrap").addClass("wpsl-no-results");$storeList.html("<li class='wpsl-no-results-msg'>"+noResultsMsg+"</li>")}
if(wpslSettings.runFitBounds==1){fitBounds()}else{map.setZoom(Number(wpslSettings.zoomLevel));map.setCenter(markersArray[0].position)}
if(wpslSettings.resetMap==1){if($.isEmptyObject(mapDefaults)){google.maps.event.addListenerOnce(map,"tilesloaded",function(){mapDefaults={centerLatlng:map.getCenter(),zoomLevel:map.getZoom()};$("#wpsl-map-controls").addClass("wpsl-reset-exists");$(".wpsl-icon-reset, #wpsl-reset-map").show()})}
$(".wpsl-icon-reset").removeClass("wpsl-in-progress")}});if(wpslSettings.mouseFocus==1&&!checkMobileUserAgent()){$("#wpsl-search-input").focus()}}
function collectAjaxData(startLatLng,resetMap,autoLoad){var maxResult,radius,customDropdownName,customDropdownValue,customCheckboxName,categoryId="",isMobile=$("#wpsl-wrap").hasClass("wpsl-mobile"),defaultFilters=$("#wpsl-wrap").hasClass("wpsl-default-filters"),ajaxData={action:"store_search",lat:startLatLng.lat(),lng:startLatLng.lng()};if(resetMap){ajaxData.max_results=wpslSettings.maxResults;ajaxData.search_radius=wpslSettings.searchRadius}else{if(isMobile||defaultFilters){maxResult=parseInt($("#wpsl-results .wpsl-dropdown").val());radius=parseInt($("#wpsl-radius .wpsl-dropdown").val())}else{maxResult=parseInt($("#wpsl-results .wpsl-selected-item").attr("data-value"));radius=parseInt($("#wpsl-radius .wpsl-selected-item").attr("data-value"))}
if(isNaN(maxResult)){ajaxData.max_results=wpslSettings.maxResults}else{ajaxData.max_results=maxResult}
if(isNaN(radius)){ajaxData.search_radius=wpslSettings.searchRadius}else{ajaxData.search_radius=radius}
if(typeof wpslSettings.categoryIds!=="undefined"){ajaxData.filter=wpslSettings.categoryIds}else if($("#wpsl-category").length>0){if(isMobile||defaultFilters){categoryId=parseInt($("#wpsl-category .wpsl-dropdown").val())}else{categoryId=parseInt($("#wpsl-category .wpsl-selected-item").attr("data-value"))}
if((!isNaN(categoryId)&&(categoryId!==0))){ajaxData.filter=categoryId}}else if($("#wpsl-checkbox-filter").length>0){if($("#wpsl-checkbox-filter input:checked").length>0){ajaxData.filter=getCheckboxIds()}}
if($(".wpsl-custom-dropdown").length>0){$(".wpsl-custom-dropdown").each(function(index){customDropdownName='';customDropdownValue='';if(isMobile||defaultFilters){customDropdownName=$(this).attr("name");customDropdownValue=$(this).val()}else{customDropdownName=$(this).attr("name");customDropdownValue=$(this).next(".wpsl-selected-item").attr("data-value")}
if(customDropdownName&&customDropdownValue){ajaxData[customDropdownName]=customDropdownValue}})}
if($(".wpsl-custom-checkboxes").length>0){$(".wpsl-custom-checkboxes").each(function(index){customCheckboxName=$(this).attr("data-name");if(customCheckboxName){ajaxData[customCheckboxName]=getCustomCheckboxValue(customCheckboxName)}})}}
if(autoLoad==1){if(typeof userGeolocation.position!=="undefined"){ajaxData.skip_cache=1}else{ajaxData.autoload=1;if(typeof wpslSettings.categoryIds!=="undefined"){ajaxData.filter=wpslSettings.categoryIds}}}
if(statistics.enabled&&autoLoad==0){ajaxData.search=$("#wpsl-search-input").val();ajaxData.statistics=statistics.address_components}
return ajaxData}
function getCustomCheckboxValue(customCheckboxName){var dataName=$("[data-name="+customCheckboxName+"]"),customValue=[];$(dataName).find("input:checked").each(function(index){customValue.push($(this).val())});return customValue.join()}
function getNoResultsMsg(){var noResults;if(typeof wpslSettings.noResults!=="undefined"&&wpslSettings.noResults!==""){noResults=wpslSettings.noResults}else{noResults=wpslLabels.noResults}
return noResults}
function getCheckboxIds(){var catIds=$("#wpsl-checkbox-filter input:checked").map(function(){return $(this).val()});catIds=catIds.get();catIds=catIds.join(',');return catIds}
function checkMarkerClusters(){if(wpslSettings.markerClusters==1){var markers,markersArrayNoStart,clusterZoom=Number(wpslSettings.clusterZoom),clusterSize=Number(wpslSettings.clusterSize);if(isNaN(clusterZoom)){clusterZoom=""}
if(isNaN(clusterSize)){clusterSize=""}
if(typeof wpslSettings.excludeStartFromCluster!=="undefined"&&wpslSettings.excludeStartFromCluster==1){markersArrayNoStart=markersArray.slice(0);markersArrayNoStart.splice(0,1)}
markers=(typeof markersArrayNoStart==="undefined")?markersArray:markersArrayNoStart;markerClusterer=new MarkerClusterer(map,markers,{gridSize:clusterSize,maxZoom:clusterZoom})}}
function addMarker(latLng,storeId,infoWindowData,draggable,infoWindow){var url,mapIcon,marker,keepStartMarker=!0;if(storeId===0){infoWindowData={store:wpslLabels.startPoint};url=markerSettings.url+wpslSettings.startMarker}else if(typeof infoWindowData.alternateMarkerUrl!=="undefined"&&infoWindowData.alternateMarkerUrl){url=infoWindowData.alternateMarkerUrl}else if(typeof infoWindowData.categoryMarkerUrl!=="undefined"&&infoWindowData.categoryMarkerUrl){url=infoWindowData.categoryMarkerUrl}else{url=markerSettings.url+wpslSettings.storeMarker}
mapIcon={url:url,scaledSize:new google.maps.Size(Number(markerSettings.scaledSize[0]),Number(markerSettings.scaledSize[1])),origin:new google.maps.Point(Number(markerSettings.origin[0]),Number(markerSettings.origin[1])),anchor:new google.maps.Point(Number(markerSettings.anchor[0]),Number(markerSettings.anchor[1]))};marker=new google.maps.Marker({position:latLng,map:map,optimized:!1,title:decodeHtmlEntity(infoWindowData.store),draggable:draggable,storeId:storeId,icon:mapIcon});markersArray.push(marker);google.maps.event.addListener(marker,"click",(function(currentMap){return function(){if(storeId!=0){if(typeof wpslSettings.markerStreetView!=="undefined"&&wpslSettings.markerStreetView==1){checkStreetViewStatus(latLng,function(){setInfoWindowContent(marker,createInfoWindowHtml(infoWindowData),infoWindow,currentMap)})}else{setInfoWindowContent(marker,createInfoWindowHtml(infoWindowData),infoWindow,currentMap)}}else{setInfoWindowContent(marker,wpslLabels.startPoint,infoWindow,currentMap)}
google.maps.event.clearListeners(infoWindow,"domready");google.maps.event.addListener(infoWindow,"domready",function(){infoWindowClickActions(marker,currentMap);checkMaxZoomLevel()})}}(map)));if(draggable){google.maps.event.addListener(marker,"dragend",function(event){deleteOverlays(keepStartMarker);map.setCenter(event.latLng);reverseGeocode(event.latLng);findStoreLocations(event.latLng,resetMap,autoLoad=!1,infoWindow)})}}
function decodeHtmlEntity(str){if(str){return str.replace(/&#(\d+);/g,function(match,dec){return String.fromCharCode(dec)})}};if(typeof wpslSettings.infoWindowStyle!=="undefined"&&wpslSettings.infoWindowStyle=="infobox"&&wpslSettings.markerClusters==1){var clusters,clusterLen,markerLen,i,j;google.maps.event.addListener(map,"zoom_changed",function(){google.maps.event.addListenerOnce(map,"idle",function(){if(typeof markerClusterer!=="undefined"){clusters=markerClusterer.clusters_;if(clusters.length){for(i=0,clusterLen=clusters.length;i<clusterLen;i++){for(j=0,markerLen=clusters[i].markers_.length;j<markerLen;j++){if(clusters[i].markers_[j].storeId==activeWindowMarkerId){if(infoWindow.getVisible()&&clusters[i].markers_[j].map===null){infoWindow.setVisible(!1)}else if(!infoWindow.getVisible()&&clusters[i].markers_[j].map!==null){infoWindow.setVisible(!0)}
break}}}}}})})}
function setInfoWindowContent(marker,infoWindowContent,infoWindow,currentMap){openInfoWindow.length=0;infoWindow.setContent(infoWindowContent);infoWindow.open(currentMap,marker);openInfoWindow.push(infoWindow);if(typeof wpslSettings.infoWindowStyle!=="undefined"&&wpslSettings.infoWindowStyle=="infobox"&&wpslSettings.markerClusters==1){activeWindowMarkerId=marker.storeId;infoWindow.setVisible(!0)}}
function infoWindowClickActions(marker,currentMap){$(".wpsl-info-actions a").on("click",function(e){var maxZoom=Number(wpslSettings.autoZoomLevel);e.stopImmediatePropagation();if($(this).hasClass("wpsl-directions")){if(wpslSettings.directionRedirect==1){return!0}else{renderDirections($(this))}}else if($(this).hasClass("wpsl-streetview")){activateStreetView(marker,currentMap)}else if($(this).hasClass("wpsl-zoom-here")){currentMap.setCenter(marker.getPosition());currentMap.setZoom(maxZoom)}
return!1})}
function checkMaxZoomLevel(){var zoomLevel=map.getZoom();if(zoomLevel>=wpslSettings.autoZoomLevel){$(".wpsl-zoom-here").hide()}else{$(".wpsl-zoom-here").show()}}
function activateStreetView(marker,currentMap){var panorama=currentMap.getStreetView();panorama.setPosition(marker.getPosition());panorama.setVisible(!0);$("#wpsl-map-controls").hide();StreetViewListener(panorama,currentMap)}
function StreetViewListener(panorama,currentMap){google.maps.event.addListener(panorama,"visible_changed",function(){if(!panorama.getVisible()){var currentZoomLevel=currentMap.getZoom();$("#wpsl-map-controls").show();currentMap.setZoom(currentZoomLevel-1);currentMap.setZoom(currentZoomLevel)}})}
function checkStreetViewStatus(latLng,callback){var service=new google.maps.StreetViewService();service.getPanoramaByLocation(latLng,50,function(result,status){streetViewAvailable=(status==google.maps.StreetViewStatus.OK)?!0:!1;callback()})}
var templateHelpers={formatPhoneNumber:function(phoneNumber){if((wpslSettings.phoneUrl==1)&&(checkMobileUserAgent())||wpslSettings.clickableDetails==1){phoneNumber="<a href='tel:"+templateHelpers.formatClickablePhoneNumber(phoneNumber)+"'>"+phoneNumber+"</a>"}
return phoneNumber},formatClickablePhoneNumber:function(phoneNumber){if((phoneNumber.indexOf("+")!=-1)&&(phoneNumber.indexOf("(0)")!=-1)){phoneNumber=phoneNumber.replace("(0)","")}
return phoneNumber.replace(/(-| |\(|\)|\.|)/g,"")},formatEmail:function(email){if(wpslSettings.clickableDetails==1){email="<a href='mailto:"+email+"'>"+email+"</a>"}
return email},createInfoWindowActions:function(id){var output,streetView="",zoomTo="";if($("#wpsl-gmap").length){if(streetViewAvailable){streetView="<a class='wpsl-streetview' href='#'>"+wpslLabels.streetView+"</a>"}
if(wpslSettings.markerZoomTo==1){zoomTo="<a class='wpsl-zoom-here' href='#'>"+wpslLabels.zoomHere+"</a>"}
output="<div class='wpsl-info-actions'>"+templateHelpers.createDirectionUrl(id)+streetView+zoomTo+"</div>"}
return output},createDirectionUrl:function(id){var directionUrl,destinationAddress,zip,url={};if(wpslSettings.directionRedirect==1){if(typeof startAddress==="undefined"){startAddress=""}
url.target="target='_blank'";if(typeof id!=="undefined"){url.src=$("[data-store-id="+id+"] .wpsl-directions").attr("href")}else{if(this.zip){zip=this.zip+", "}else{zip=""}
destinationAddress=this.address+", "+this.city+", "+zip+this.country;url.src="https://www.google.com/maps/dir/?api=1&origin="+templateHelpers.rfc3986EncodeURIComponent(startAddress)+"&destination="+templateHelpers.rfc3986EncodeURIComponent(destinationAddress)+"&travelmode="+wpslSettings.directionsTravelMode.toLowerCase()+""}}else{url={src:"#",target:""}}
directionUrl="<a class='wpsl-directions' "+url.target+" href='"+url.src+"'>"+wpslLabels.directions+"</a>";return directionUrl},rfc3986EncodeURIComponent:function(str){return encodeURIComponent(str).replace(/[!'()*]/g,escape)}};function createInfoWindowHtml(infoWindowData){var windowContent,template;if($("#wpsl-base-gmap_0").length){template=$("#wpsl-cpt-info-window-template").html()}else{template=$("#wpsl-info-window-template").html()}
windowContent=_.template(template)(infoWindowData);return windowContent}
function fitBounds(){var i,markerLen,maxZoom=Number(wpslSettings.autoZoomLevel),bounds=new google.maps.LatLngBounds();attachBoundsChangedListener(map,maxZoom);for(i=0,markerLen=markersArray.length;i<markerLen;i++){bounds.extend(markersArray[i].position)}
map.fitBounds(bounds)}
function deleteOverlays(keepStartMarker){var markerLen,i;directionsDisplay.setMap(null);if(markersArray){for(i=0,markerLen=markersArray.length;i<markerLen;i++){if(keepStartMarker){if(markersArray[i].draggable!=!0){markersArray[i].setMap(null)}else{startMarkerData=markersArray[i]}}else{markersArray[i].setMap(null)}}
markersArray.length=0}
if(markerClusterer){markerClusterer.clearMarkers()}}
function geocodeErrors(status){var msg;switch(status){case "ZERO_RESULTS":msg=wpslLabels.noResults;break;case "OVER_QUERY_LIMIT":msg=wpslLabels.queryLimit;break;default:msg=wpslLabels.generalError;break}
console.error(msg)}
function directionErrors(status){var msg;switch(status){case "NOT_FOUND":case "ZERO_RESULTS":msg=wpslLabels.noDirectionsFound;break;case "OVER_QUERY_LIMIT":msg=wpslLabels.queryLimit;break;default:msg=wpslLabels.generalError;break}
console.error(msg)}
$("#wpsl-stores").on("click",".wpsl-store-details",function(){var i,len,$parentLi=$(this).parents("li"),storeId=$parentLi.data("store-id");if(wpslSettings.moreInfoLocation=="info window"){for(i=0,len=markersArray.length;i<len;i++){if(markersArray[i].storeId==storeId){google.maps.event.trigger(markersArray[i],"click")}}}else{if($parentLi.find(".wpsl-more-info-listings").is(":visible")){$(this).removeClass("wpsl-active-details")}else{$(this).addClass("wpsl-active-details")}
$parentLi.siblings().find(".wpsl-store-details").removeClass("wpsl-active-details");$parentLi.siblings().find(".wpsl-more-info-listings").hide();$parentLi.find(".wpsl-more-info-listings").toggle()}
if(wpslSettings.templateId!="default"||wpslSettings.moreInfoLocation=="store listings"){return!1}});function createDropdowns(){var maxDropdownHeight=Number(wpslSettings.maxDropdownHeight);$(".wpsl-dropdown").each(function(index){var active,maxHeight,$this=$(this);$this.$dropdownWrap=$this.wrap("<div class='wpsl-dropdown'></div>").parent();$this.$selectedVal=$this.val();$this.$dropdownElem=$("<div><ul/></div>").appendTo($this.$dropdownWrap);$this.$dropdown=$this.$dropdownElem.find("ul");$this.$options=$this.$dropdownWrap.find("option");$this.hide().removeClass("wpsl-dropdown");$.each($this.$options,function(){if($(this).val()==$this.$selectedVal){active='class="wpsl-selected-dropdown"'}else{active=''}
$this.$dropdown.append("<li data-value="+$(this).val()+" "+active+">"+$(this).text()+"</li>")});$this.$dropdownElem.before("<span data-value="+$this.find(":selected").val()+" class='wpsl-selected-item'>"+$this.find(":selected").text()+"</span>");$this.$dropdownItem=$this.$dropdownElem.find("li");$this.$dropdownWrap.on("click",function(e){if($(this).hasClass("wpsl-active")){$(this).removeClass("wpsl-active");return}
closeAllDropdowns();$(this).toggleClass("wpsl-active");maxHeight=0;if($(this).hasClass("wpsl-active")){$this.$dropdownItem.each(function(index){maxHeight+=$(this).outerHeight()});$this.$dropdownElem.css("height",maxHeight+2+"px")}else{$this.$dropdownElem.css("height",0)}
if(maxHeight>maxDropdownHeight){$(this).addClass("wpsl-scroll-required");$this.$dropdownElem.css("height",(maxDropdownHeight)+"px")}
e.stopPropagation()});$this.$dropdownItem.on("click",function(e){$this.$dropdownWrap.find($(".wpsl-selected-item")).html($(this).text()).attr("data-value",$(this).attr("data-value"));$this.$dropdownItem.removeClass("wpsl-selected-dropdown");$(this).addClass("wpsl-selected-dropdown");closeAllDropdowns();e.stopPropagation()})});$(document).click(function(){closeAllDropdowns()})}
function closeAllDropdowns(){$(".wpsl-dropdown").removeClass("wpsl-active");$(".wpsl-dropdown div").css("height",0)}
function checkWidgetSubmit(){if($(".wpsl-search").hasClass("wpsl-widget")){$("#wpsl-search-btn").trigger("click");$(".wpsl-search").removeClass("wpsl-widget")}}
function maybeApplyTabFix(){var mapNumber,len;if(_.isArray(wpslSettings.mapTabAnchor)){for(mapNumber=0,len=mapsArray.length;mapNumber<len;mapNumber++){fixGreyTabMap(mapsArray[mapNumber],wpslSettings.mapTabAnchor[mapNumber],mapNumber)}}else if($("a[href='#"+wpslSettings.mapTabAnchor+"']").length){fixGreyTabMap(map,wpslSettings.mapTabAnchor)}}
function fixGreyTabMap(currentMap,mapTabAnchor,mapNumber){var mapZoom,mapCenter,maxZoom,bounds,tabMap,returnBool=Number(wpslSettings.mapTabAnchorReturn)?!0:!1,$wpsl_tab=$("a[href='#"+mapTabAnchor+"']");if(typeof currentMap.maxZoom!=="undefined"){maxZoom=currentMap.maxZoom}else{maxZoom=Number(wpslSettings.autoZoomLevel)}
if(typeof mapNumber!=="undefined"&&mapNumber==0){$wpsl_tab.addClass("wpsl-fitbounds")}
$wpsl_tab.on("click",function(){setTimeout(function(){if(typeof currentMap.map!=="undefined"){bounds=currentMap.bounds;tabMap=currentMap.map}else{tabMap=currentMap}
mapZoom=tabMap.getZoom();mapCenter=tabMap.getCenter();google.maps.event.trigger(tabMap,"resize");if(!$wpsl_tab.hasClass("wpsl-fitbounds")){attachBoundsChangedListener(tabMap,maxZoom);tabMap.setZoom(mapZoom);tabMap.setCenter(mapCenter);if(typeof bounds!=="undefined"){tabMap.fitBounds(bounds)}else{fitBounds()}
$wpsl_tab.addClass("wpsl-fitbounds")}},50);return returnBool})}
function attachBoundsChangedListener(map,maxZoom){google.maps.event.addListenerOnce(map,"bounds_changed",function(){google.maps.event.addListenerOnce(map,"idle",function(){if(this.getZoom()>maxZoom){this.setZoom(maxZoom)}})})}});
/*! This file is auto-generated */
!function(n,r){var t,e;"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define("underscore",r):(n="undefined"!=typeof globalThis?globalThis:n||self,t=n._,(e=n._=r()).noConflict=function(){return n._=t,e})}(this,function(){var n="1.13.6",r="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},e=Array.prototype,F=Object.prototype,V="undefined"!=typeof Symbol?Symbol.prototype:null,P=e.push,f=e.slice,s=F.toString,q=F.hasOwnProperty,t="undefined"!=typeof ArrayBuffer,u="undefined"!=typeof DataView,U=Array.isArray,W=Object.keys,z=Object.create,L=t&&ArrayBuffer.isView,$=isNaN,C=isFinite,K=!{toString:null}.propertyIsEnumerable("toString"),J=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],G=Math.pow(2,53)-1;function l(u,o){return o=null==o?u.length-1:+o,function(){for(var n=Math.max(arguments.length-o,0),r=Array(n),t=0;t<n;t++)r[t]=arguments[t+o];switch(o){case 0:return u.call(this,r);case 1:return u.call(this,arguments[0],r);case 2:return u.call(this,arguments[0],arguments[1],r)}for(var e=Array(o+1),t=0;t<o;t++)e[t]=arguments[t];return e[o]=r,u.apply(this,e)}}function o(n){var r=typeof n;return"function"==r||"object"==r&&!!n}function H(n){return void 0===n}function Q(n){return!0===n||!1===n||"[object Boolean]"===s.call(n)}function i(n){var r="[object "+n+"]";return function(n){return s.call(n)===r}}var X=i("String"),Y=i("Number"),Z=i("Date"),nn=i("RegExp"),rn=i("Error"),tn=i("Symbol"),en=i("ArrayBuffer"),a=i("Function"),r=r.document&&r.document.childNodes,p=a="function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof r?function(n){return"function"==typeof n||!1}:a,r=i("Object"),un=u&&r(new DataView(new ArrayBuffer(8))),a="undefined"!=typeof Map&&r(new Map),u=i("DataView");var h=un?function(n){return null!=n&&p(n.getInt8)&&en(n.buffer)}:u,v=U||i("Array");function y(n,r){return null!=n&&q.call(n,r)}var on=i("Arguments"),an=(!function(){on(arguments)||(on=function(n){return y(n,"callee")})}(),on);function fn(n){return Y(n)&&$(n)}function cn(n){return function(){return n}}function ln(r){return function(n){n=r(n);return"number"==typeof n&&0<=n&&n<=G}}function sn(r){return function(n){return null==n?void 0:n[r]}}var d=sn("byteLength"),pn=ln(d),hn=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var vn=t?function(n){return L?L(n)&&!h(n):pn(n)&&hn.test(s.call(n))}:cn(!1),g=sn("length");function yn(n,r){r=function(r){for(var t={},n=r.length,e=0;e<n;++e)t[r[e]]=!0;return{contains:function(n){return!0===t[n]},push:function(n){return t[n]=!0,r.push(n)}}}(r);var t=J.length,e=n.constructor,u=p(e)&&e.prototype||F,o="constructor";for(y(n,o)&&!r.contains(o)&&r.push(o);t--;)(o=J[t])in n&&n[o]!==u[o]&&!r.contains(o)&&r.push(o)}function b(n){if(!o(n))return[];if(W)return W(n);var r,t=[];for(r in n)y(n,r)&&t.push(r);return K&&yn(n,t),t}function dn(n,r){var t=b(r),e=t.length;if(null==n)return!e;for(var u=Object(n),o=0;o<e;o++){var i=t[o];if(r[i]!==u[i]||!(i in u))return!1}return!0}function m(n){return n instanceof m?n:this instanceof m?void(this._wrapped=n):new m(n)}function gn(n){return new Uint8Array(n.buffer||n,n.byteOffset||0,d(n))}m.VERSION=n,m.prototype.valueOf=m.prototype.toJSON=m.prototype.value=function(){return this._wrapped},m.prototype.toString=function(){return String(this._wrapped)};var bn="[object DataView]";function mn(n,r,t,e){var u;return n===r?0!==n||1/n==1/r:null!=n&&null!=r&&(n!=n?r!=r:("function"==(u=typeof n)||"object"==u||"object"==typeof r)&&function n(r,t,e,u){r instanceof m&&(r=r._wrapped);t instanceof m&&(t=t._wrapped);var o=s.call(r);if(o!==s.call(t))return!1;if(un&&"[object Object]"==o&&h(r)){if(!h(t))return!1;o=bn}switch(o){case"[object RegExp]":case"[object String]":return""+r==""+t;case"[object Number]":return+r!=+r?+t!=+t:0==+r?1/+r==1/t:+r==+t;case"[object Date]":case"[object Boolean]":return+r==+t;case"[object Symbol]":return V.valueOf.call(r)===V.valueOf.call(t);case"[object ArrayBuffer]":case bn:return n(gn(r),gn(t),e,u)}o="[object Array]"===o;if(!o&&vn(r)){var i=d(r);if(i!==d(t))return!1;if(r.buffer===t.buffer&&r.byteOffset===t.byteOffset)return!0;o=!0}if(!o){if("object"!=typeof r||"object"!=typeof t)return!1;var i=r.constructor,a=t.constructor;if(i!==a&&!(p(i)&&i instanceof i&&p(a)&&a instanceof a)&&"constructor"in r&&"constructor"in t)return!1}e=e||[];u=u||[];var f=e.length;for(;f--;)if(e[f]===r)return u[f]===t;e.push(r);u.push(t);if(o){if((f=r.length)!==t.length)return!1;for(;f--;)if(!mn(r[f],t[f],e,u))return!1}else{var c,l=b(r);if(f=l.length,b(t).length!==f)return!1;for(;f--;)if(c=l[f],!y(t,c)||!mn(r[c],t[c],e,u))return!1}e.pop();u.pop();return!0}(n,r,t,e))}function c(n){if(!o(n))return[];var r,t=[];for(r in n)t.push(r);return K&&yn(n,t),t}function jn(e){var u=g(e);return function(n){if(null==n)return!1;var r=c(n);if(g(r))return!1;for(var t=0;t<u;t++)if(!p(n[e[t]]))return!1;return e!==wn||!p(n[_n])}}var _n="forEach",r=["clear","delete"],u=["get","has","set"],U=r.concat(_n,u),wn=r.concat(u),t=["add"].concat(r,_n,"has"),u=a?jn(U):i("Map"),r=a?jn(wn):i("WeakMap"),U=a?jn(t):i("Set"),a=i("WeakSet");function j(n){for(var r=b(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e}function An(n){for(var r={},t=b(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r}function xn(n){var r,t=[];for(r in n)p(n[r])&&t.push(r);return t.sort()}function Sn(f,c){return function(n){var r=arguments.length;if(c&&(n=Object(n)),!(r<2||null==n))for(var t=1;t<r;t++)for(var e=arguments[t],u=f(e),o=u.length,i=0;i<o;i++){var a=u[i];c&&void 0!==n[a]||(n[a]=e[a])}return n}}var On=Sn(c),_=Sn(b),Mn=Sn(c,!0);function En(n){var r;return o(n)?z?z(n):((r=function(){}).prototype=n,n=new r,r.prototype=null,n):{}}function Bn(n){return v(n)?n:[n]}function w(n){return m.toPath(n)}function Nn(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0}function In(n,r,t){n=Nn(n,w(r));return H(n)?t:n}function Tn(n){return n}function A(r){return r=_({},r),function(n){return dn(n,r)}}function kn(r){return r=w(r),function(n){return Nn(n,r)}}function x(u,o,n){if(void 0===o)return u;switch(null==n?3:n){case 1:return function(n){return u.call(o,n)};case 3:return function(n,r,t){return u.call(o,n,r,t)};case 4:return function(n,r,t,e){return u.call(o,n,r,t,e)}}return function(){return u.apply(o,arguments)}}function Dn(n,r,t){return null==n?Tn:p(n)?x(n,r,t):(o(n)&&!v(n)?A:kn)(n)}function Rn(n,r){return Dn(n,r,1/0)}function S(n,r,t){return m.iteratee!==Rn?m.iteratee(n,r):Dn(n,r,t)}function Fn(){}function Vn(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))}m.toPath=Bn,m.iteratee=Rn;var O=Date.now||function(){return(new Date).getTime()};function Pn(r){function t(n){return r[n]}var n="(?:"+b(r).join("|")+")",e=RegExp(n),u=RegExp(n,"g");return function(n){return e.test(n=null==n?"":""+n)?n.replace(u,t):n}}var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},qn=Pn(t),t=Pn(An(t)),Un=m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Wn=/(.)^/,zn={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ln=/\\|'|\r|\n|\u2028|\u2029/g;function $n(n){return"\\"+zn[n]}var Cn=/^\s*(\w|\$)+\s*$/;var Kn=0;function Jn(n,r,t,e,u){return e instanceof r?(e=En(n.prototype),o(r=n.apply(e,u))?r:e):n.apply(t,u)}var M=l(function(u,o){function i(){for(var n=0,r=o.length,t=Array(r),e=0;e<r;e++)t[e]=o[e]===a?arguments[n++]:o[e];for(;n<arguments.length;)t.push(arguments[n++]);return Jn(u,i,this,this,t)}var a=M.placeholder;return i}),Gn=(M.placeholder=m,l(function(r,t,e){var u;if(p(r))return u=l(function(n){return Jn(r,u,t,this,e.concat(n))});throw new TypeError("Bind must be called on a function")})),E=ln(g);function B(n,r,t,e){if(e=e||[],r||0===r){if(r<=0)return e.concat(n)}else r=1/0;for(var u=e.length,o=0,i=g(n);o<i;o++){var a=n[o];if(E(a)&&(v(a)||an(a)))if(1<r)B(a,r-1,t,e),u=e.length;else for(var f=0,c=a.length;f<c;)e[u++]=a[f++];else t||(e[u++]=a)}return e}var Hn=l(function(n,r){var t=(r=B(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=Gn(n[e],n)}return n});var Qn=l(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),Xn=M(Qn,m,1);function Yn(n){return function(){return!n.apply(this,arguments)}}function Zn(n,r){var t;return function(){return 0<--n&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}}var nr=M(Zn,2);function rr(n,r,t){r=S(r,t);for(var e,u=b(n),o=0,i=u.length;o<i;o++)if(r(n[e=u[o]],e,n))return e}function tr(o){return function(n,r,t){r=S(r,t);for(var e=g(n),u=0<o?0:e-1;0<=u&&u<e;u+=o)if(r(n[u],u,n))return u;return-1}}var er=tr(1),ur=tr(-1);function or(n,r,t,e){for(var u=(t=S(t,e,1))(r),o=0,i=g(n);o<i;){var a=Math.floor((o+i)/2);t(n[a])<u?o=a+1:i=a}return o}function ir(o,i,a){return function(n,r,t){var e=0,u=g(n);if("number"==typeof t)0<o?e=0<=t?t:Math.max(t+u,e):u=0<=t?Math.min(t+1,u):t+u+1;else if(a&&t&&u)return n[t=a(n,r)]===r?t:-1;if(r!=r)return 0<=(t=i(f.call(n,e,u),fn))?t+e:-1;for(t=0<o?e:u-1;0<=t&&t<u;t+=o)if(n[t]===r)return t;return-1}}var ar=ir(1,er,or),fr=ir(-1,ur);function cr(n,r,t){r=(E(n)?er:rr)(n,r,t);if(void 0!==r&&-1!==r)return n[r]}function N(n,r,t){if(r=x(r,t),E(n))for(u=0,o=n.length;u<o;u++)r(n[u],u,n);else for(var e=b(n),u=0,o=e.length;u<o;u++)r(n[e[u]],e[u],n);return n}function I(n,r,t){r=S(r,t);for(var e=!E(n)&&b(n),u=(e||n).length,o=Array(u),i=0;i<u;i++){var a=e?e[i]:i;o[i]=r(n[a],a,n)}return o}function lr(p){return function(n,r,t,e){var u=3<=arguments.length,o=n,i=x(r,e,4),a=t,f=!E(o)&&b(o),c=(f||o).length,l=0<p?0:c-1;for(u||(a=o[f?f[l]:l],l+=p);0<=l&&l<c;l+=p){var s=f?f[l]:l;a=i(a,o[s],s,o)}return a}}var sr=lr(1),pr=lr(-1);function T(n,e,r){var u=[];return e=S(e,r),N(n,function(n,r,t){e(n,r,t)&&u.push(n)}),u}function hr(n,r,t){r=S(r,t);for(var e=!E(n)&&b(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(!r(n[i],i,n))return!1}return!0}function vr(n,r,t){r=S(r,t);for(var e=!E(n)&&b(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(r(n[i],i,n))return!0}return!1}function k(n,r,t,e){return E(n)||(n=j(n)),0<=ar(n,r,t="number"==typeof t&&!e?t:0)}var yr=l(function(n,t,e){var u,o;return p(t)?o=t:(t=w(t),u=t.slice(0,-1),t=t[t.length-1]),I(n,function(n){var r=o;if(!r){if(null==(n=u&&u.length?Nn(n,u):n))return;r=n[t]}return null==r?r:r.apply(n,e)})});function dr(n,r){return I(n,kn(r))}function gr(n,e,r){var t,u,o=-1/0,i=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=E(n)?n:j(n)).length;a<f;a++)null!=(t=n[a])&&o<t&&(o=t);else e=S(e,r),N(n,function(n,r,t){u=e(n,r,t),(i<u||u===-1/0&&o===-1/0)&&(o=n,i=u)});return o}var br=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function mr(n){return n?v(n)?f.call(n):X(n)?n.match(br):E(n)?I(n,Tn):j(n):[]}function jr(n,r,t){if(null==r||t)return(n=E(n)?n:j(n))[Vn(n.length-1)];for(var e=mr(n),t=g(e),u=(r=Math.max(Math.min(r,t),0),t-1),o=0;o<r;o++){var i=Vn(o,u),a=e[o];e[o]=e[i],e[i]=a}return e.slice(0,r)}function D(o,r){return function(t,e,n){var u=r?[[],[]]:{};return e=S(e,n),N(t,function(n,r){r=e(n,r,t);o(u,n,r)}),u}}var _r=D(function(n,r,t){y(n,t)?n[t].push(r):n[t]=[r]}),wr=D(function(n,r,t){n[t]=r}),Ar=D(function(n,r,t){y(n,t)?n[t]++:n[t]=1}),xr=D(function(n,r,t){n[t?0:1].push(r)},!0);function Sr(n,r,t){return r in t}var Or=l(function(n,r){var t={},e=r[0];if(null!=n){p(e)?(1<r.length&&(e=x(e,r[1])),r=c(n)):(e=Sr,r=B(r,!1,!1),n=Object(n));for(var u=0,o=r.length;u<o;u++){var i=r[u],a=n[i];e(a,i,n)&&(t[i]=a)}}return t}),Mr=l(function(n,t){var r,e=t[0];return p(e)?(e=Yn(e),1<t.length&&(r=t[1])):(t=I(B(t,!1,!1),String),e=function(n,r){return!k(t,r)}),Or(n,e,r)});function Er(n,r,t){return f.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))}function Br(n,r,t){return null==n||n.length<1?null==r||t?void 0:[]:null==r||t?n[0]:Er(n,n.length-r)}function R(n,r,t){return f.call(n,null==r||t?1:r)}var Nr=l(function(n,r){return r=B(r,!0,!0),T(n,function(n){return!k(r,n)})}),Ir=l(function(n,r){return Nr(n,r)});function Tr(n,r,t,e){Q(r)||(e=t,t=r,r=!1),null!=t&&(t=S(t,e));for(var u=[],o=[],i=0,a=g(n);i<a;i++){var f=n[i],c=t?t(f,i,n):f;r&&!t?(i&&o===c||u.push(f),o=c):t?k(o,c)||(o.push(c),u.push(f)):k(u,f)||u.push(f)}return u}var kr=l(function(n){return Tr(B(n,!0,!0))});function Dr(n){for(var r=n&&gr(n,g).length||0,t=Array(r),e=0;e<r;e++)t[e]=dr(n,e);return t}var Rr=l(Dr);function Fr(n,r){return n._chain?m(r).chain():r}function Vr(t){return N(xn(t),function(n){var r=m[n]=t[n];m.prototype[n]=function(){var n=[this._wrapped];return P.apply(n,arguments),Fr(this,r.apply(m,n))}}),m}N(["pop","push","reverse","shift","sort","splice","unshift"],function(r){var t=e[r];m.prototype[r]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==r&&"splice"!==r||0!==n.length||delete n[0]),Fr(this,n)}}),N(["concat","join","slice"],function(n){var r=e[n];m.prototype[n]=function(){var n=this._wrapped;return Fr(this,n=null!=n?r.apply(n,arguments):n)}});n=Vr({__proto__:null,VERSION:n,restArguments:l,isObject:o,isNull:function(n){return null===n},isUndefined:H,isBoolean:Q,isElement:function(n){return!(!n||1!==n.nodeType)},isString:X,isNumber:Y,isDate:Z,isRegExp:nn,isError:rn,isSymbol:tn,isArrayBuffer:en,isDataView:h,isArray:v,isFunction:p,isArguments:an,isFinite:function(n){return!tn(n)&&C(n)&&!isNaN(parseFloat(n))},isNaN:fn,isTypedArray:vn,isEmpty:function(n){var r;return null==n||("number"==typeof(r=g(n))&&(v(n)||X(n)||an(n))?0===r:0===g(b(n)))},isMatch:dn,isEqual:function(n,r){return mn(n,r)},isMap:u,isWeakMap:r,isSet:U,isWeakSet:a,keys:b,allKeys:c,values:j,pairs:function(n){for(var r=b(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},invert:An,functions:xn,methods:xn,extend:On,extendOwn:_,assign:_,defaults:Mn,create:function(n,r){return n=En(n),r&&_(n,r),n},clone:function(n){return o(n)?v(n)?n.slice():On({},n):n},tap:function(n,r){return r(n),n},get:In,has:function(n,r){for(var t=(r=w(r)).length,e=0;e<t;e++){var u=r[e];if(!y(n,u))return!1;n=n[u]}return!!t},mapObject:function(n,r,t){r=S(r,t);for(var e=b(n),u=e.length,o={},i=0;i<u;i++){var a=e[i];o[a]=r(n[a],a,n)}return o},identity:Tn,constant:cn,noop:Fn,toPath:Bn,property:kn,propertyOf:function(r){return null==r?Fn:function(n){return In(r,n)}},matcher:A,matches:A,times:function(n,r,t){var e=Array(Math.max(0,n));r=x(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},random:Vn,now:O,escape:qn,unescape:t,templateSettings:Un,template:function(o,n,r){n=Mn({},n=!n&&r?r:n,m.templateSettings);var t,r=RegExp([(n.escape||Wn).source,(n.interpolate||Wn).source,(n.evaluate||Wn).source].join("|")+"|$","g"),i=0,a="__p+='";if(o.replace(r,function(n,r,t,e,u){return a+=o.slice(i,u).replace(Ln,$n),i=u+n.length,r?a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":t?a+="'+\n((__t=("+t+"))==null?'':__t)+\n'":e&&(a+="';\n"+e+"\n__p+='"),n}),a+="';\n",r=n.variable){if(!Cn.test(r))throw new Error("variable is not a bare identifier: "+r)}else a="with(obj||{}){\n"+a+"}\n",r="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{t=new Function(r,"_",a)}catch(n){throw n.source=a,n}function e(n){return t.call(this,n,m)}return e.source="function("+r+"){\n"+a+"}",e},result:function(n,r,t){var e=(r=w(r)).length;if(!e)return p(t)?t.call(n):t;for(var u=0;u<e;u++){var o=null==n?void 0:n[r[u]];void 0===o&&(o=t,u=e),n=p(o)?o.call(n):o}return n},uniqueId:function(n){var r=++Kn+"";return n?n+r:r},chain:function(n){return(n=m(n))._chain=!0,n},iteratee:Rn,partial:M,bind:Gn,bindAll:Hn,memoize:function(e,u){function o(n){var r=o.cache,t=""+(u?u.apply(this,arguments):n);return y(r,t)||(r[t]=e.apply(this,arguments)),r[t]}return o.cache={},o},delay:Qn,defer:Xn,throttle:function(t,e,u){function o(){l=!1===u.leading?0:O(),i=null,c=t.apply(a,f),i||(a=f=null)}function n(){var n=O(),r=(l||!1!==u.leading||(l=n),e-(n-l));return a=this,f=arguments,r<=0||e<r?(i&&(clearTimeout(i),i=null),l=n,c=t.apply(a,f),i||(a=f=null)):i||!1===u.trailing||(i=setTimeout(o,r)),c}var i,a,f,c,l=0;return u=u||{},n.cancel=function(){clearTimeout(i),l=0,i=a=f=null},n},debounce:function(r,t,e){function u(){var n=O()-i;n<t?o=setTimeout(u,t-n):(o=null,e||(f=r.apply(c,a)),o||(a=c=null))}var o,i,a,f,c,n=l(function(n){return c=this,a=n,i=O(),o||(o=setTimeout(u,t),e&&(f=r.apply(c,a))),f});return n.cancel=function(){clearTimeout(o),o=a=c=null},n},wrap:function(n,r){return M(r,n)},negate:Yn,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},after:function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},before:Zn,once:nr,findKey:rr,findIndex:er,findLastIndex:ur,sortedIndex:or,indexOf:ar,lastIndexOf:fr,find:cr,detect:cr,findWhere:function(n,r){return cr(n,A(r))},each:N,forEach:N,map:I,collect:I,reduce:sr,foldl:sr,inject:sr,reduceRight:pr,foldr:pr,filter:T,select:T,reject:function(n,r,t){return T(n,Yn(S(r)),t)},every:hr,all:hr,some:vr,any:vr,contains:k,includes:k,include:k,invoke:yr,pluck:dr,where:function(n,r){return T(n,A(r))},max:gr,min:function(n,e,r){var t,u,o=1/0,i=1/0;if(null==e||"number"==typeof e&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=E(n)?n:j(n)).length;a<f;a++)null!=(t=n[a])&&t<o&&(o=t);else e=S(e,r),N(n,function(n,r,t){((u=e(n,r,t))<i||u===1/0&&o===1/0)&&(o=n,i=u)});return o},shuffle:function(n){return jr(n,1/0)},sample:jr,sortBy:function(n,e,r){var u=0;return e=S(e,r),dr(I(n,function(n,r,t){return{value:n,index:u++,criteria:e(n,r,t)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(e<t||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")},groupBy:_r,indexBy:wr,countBy:Ar,partition:xr,toArray:mr,size:function(n){return null==n?0:(E(n)?n:b(n)).length},pick:Or,omit:Mr,first:Br,head:Br,take:Br,initial:Er,last:function(n,r,t){return null==n||n.length<1?null==r||t?void 0:[]:null==r||t?n[n.length-1]:R(n,Math.max(0,n.length-r))},rest:R,tail:R,drop:R,compact:function(n){return T(n,Boolean)},flatten:function(n,r){return B(n,r,!1)},without:Ir,uniq:Tr,unique:Tr,union:kr,intersection:function(n){for(var r=[],t=arguments.length,e=0,u=g(n);e<u;e++){var o=n[e];if(!k(r,o)){for(var i=1;i<t&&k(arguments[i],o);i++);i===t&&r.push(o)}}return r},difference:Nr,unzip:Dr,transpose:Dr,zip:Rr,object:function(n,r){for(var t={},e=0,u=g(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t},range:function(n,r,t){null==r&&(r=n||0,n=0),t=t||(r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),o=0;o<e;o++,n+=t)u[o]=n;return u},chunk:function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(f.call(n,e,e+=r));return t},mixin:Vr,default:m});return n._=n});
